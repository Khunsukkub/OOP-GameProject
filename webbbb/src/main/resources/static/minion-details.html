<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K.O.M.B.A.T - Minion Details</title>
    <style>
        .center-button {
            text-align: center;
            margin: 20px 0;
        }
    </style>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
<div class="container">
    <h1>Select Your Minions</h1>

    <div id="minionSelection">
        <label for="numMinions">Choose number of Minions (1-5):</label>
        <input type="number" id="numMinions" min="1" max="5" value="1">
        <button onclick="generateMinionButtons()">Confirm ‚úÖ</button>
    </div>

    <div class="minion-list" id="minionList"></div>

    <div class="center-button">
        <button id="backToSelection" style="display:none;" onclick="showMinionSelection()">Change Number of Minions ‚¨ÖÔ∏è</button>
    </div>

    <div id="minionDetails" style="display:none;">
        <h2 id="minionTitle"></h2>
        <textarea id="minionCode" placeholder="Write your minion's code here..."
                  onchange="updateMinionCode()"></textarea>
    </div>

    <button onclick="submitAll()">Submit All Minions üöÄ</button>
    <button onclick="goBack()">Back ‚¨ÖÔ∏è</button>
</div>

<script>
    let minionData = {};
    let selectedMinions = 1;

    function generateMinionButtons() {
        selectedMinions = parseInt(document.getElementById('numMinions').value);
        const minionList = document.getElementById('minionList');
        minionList.innerHTML = '';

        document.getElementById('minionSelection').style.display = 'none';
        document.getElementById('backToSelection').style.display = 'block';

        for (let i = 1; i <= selectedMinions; i++) {
            let button = document.createElement('button');
            button.innerText = `Minion ${i}`;
            button.onclick = () => selectMinion(i);
            minionList.appendChild(button);
        }
    }

    function showMinionSelection() {
        document.getElementById('minionSelection').style.display = 'block';
        document.getElementById('backToSelection').style.display = 'none';
        document.getElementById('minionDetails').style.display = 'none';
        minionData = {};
    }

    function selectMinion(minionNumber) {
        document.getElementById('minionDetails').style.display = 'block';
        document.getElementById('minionTitle').innerText = `Minion ${minionNumber} Code`;
        document.getElementById('minionCode').value = minionData[minionNumber] || '';
    }

    function updateMinionCode() {
        const minionNumber = parseInt(document.getElementById('minionTitle').innerText.split(' ')[1]);
        const code = document.getElementById('minionCode').value;
        minionData[minionNumber] = code;
    }

    function submitAll() {
        const emptyMinions = [];
        for (let i = 1; i <= selectedMinions; i++) {
            if (!minionData[i] || minionData[i].trim() === '') {
                emptyMinions.push(i);
            }
        }

        if (emptyMinions.length > 0) {
            alert(`Please enter code for Minion(s): ${emptyMinions.join(', ')}`);
            return;
        }

        alert('All minion codes submitted! Redirecting to the game...');
        const params = new URLSearchParams(window.location.search);
        window.location.href = `game.html?player1=${params.get('player1')}&player2=${params.get('player2')}&mode=${params.get('mode')}`;
    }

    function goBack() {
        window.history.back();
    }
</script>
</body>
</html>